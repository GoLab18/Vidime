<main id="main-content">
  <div id="main-section">
    <div class="channel-tabs border-bottom-wrapper">
      <button 
        [class.active]="activeTab === ChannelTab.VIDEOS"
        (click)="switchTab(ChannelTab.VIDEOS)"
      >Videos</button>
      <button 
        [class.active]="activeTab === ChannelTab.PLAYLISTS"
        (click)="switchTab(ChannelTab.PLAYLISTS)"
      >Playlists</button>
    </div>

    <div class="channel-content">
      <div class="horizontal-list" [class.hidden]="activeTab !== ChannelTab.VIDEOS">
        <div class="list-header">
          <h3>Newest Videos</h3>
          <span class="list-count">{{ newestVideos.length }} {{ newestVideos.length === 1 ? 'video' : 'videos' }}</span>
        </div>
        <app-horizontal-group-scroll [items]="newestVideos" type="video"></app-horizontal-group-scroll>
      </div>

      <div class="horizontal-list" [class.hidden]="activeTab !== ChannelTab.VIDEOS">
        <div class="list-header">
          <h3>Most Viewed Videos</h3>
          <span class="list-count">{{ mostViewedVideos.length }} {{ mostViewedVideos.length === 1 ? 'video' : 'videos' }}</span>
        </div>
        <app-horizontal-group-scroll [items]="mostViewedVideos" type="video"></app-horizontal-group-scroll>
      </div>

      <div class="horizontal-list" [class.hidden]="activeTab !== ChannelTab.VIDEOS">
        <div class="list-header">
          <h3>Best Rated Videos</h3>
          <span class="list-count">{{ bestRatedVideos.length }} {{ bestRatedVideos.length === 1 ? 'video' : 'videos' }}</span>
        </div>
        <app-horizontal-group-scroll [items]="bestRatedVideos" type="video"></app-horizontal-group-scroll>
      </div>

      <div class="horizontal-list" [class.hidden]="activeTab !== ChannelTab.PLAYLISTS">
        <div class="list-header list-header-space">
          <h3>Playlists</h3>
          <span class="list-count">{{ playlists.length }} {{ playlists.length === 1 ? 'playlist' : 'playlists' }}</span>
        </div>
        <div id="main-playlist-grid">
          <app-dynamic-size-tile-grid [playlists]="playlists"></app-dynamic-size-tile-grid>
        </div>
      </div>
    </div>
  </div>

  <div id="channel-side-section">
    <div id="channel-content">
      <div id="channel-avatar-name">
        <div id="channel-avatar">
          @if (channel) {
            <img [src]="channel.picture" [alt]="channel.name" id="avatar-image">
          }
        </div>
        @if (channel) {
          <div class="channel-name">
            {{ channel.name }}
            @if (channel.verified) {
              <i class="material-icons verified">verified</i>
            }
          </div>
        }
      </div>
      <div id="channel-utils">
        <div id="channel-stats">
          @if (channel) {
            <span>Joined {{ channel.createdAt | formatDate }}</span>
            <span class="dot">•</span>
            <span>{{ channel.videosAmount | formatNumber:'video':'videos' }}</span>
            <span class="dot">•</span>
            <span>{{ channel.subscribersCount | formatNumber:'sub':'subs' }}</span>
          }
        </div>
        <div id="channel-actions-wrapper">
          <div id="channel-actions">
            @if (isSubscriptionAvailable) {
              @if (subscription) {
                <button id="action-button" class="subscribed" (click)="unsubscribeButtonInvoked()">
                  <span>Unsubscribe</span>
                </button>
              } @else {
                <button id="action-button" (click)="subscribeButtonInvoked()">
                  <span>Subscribe</span>
                </button>
              }
            }
            <button id="action-button">
              <span>{{ isCurrentUsersChannel ? 'Share your channel' : 'Share' }}</span>
              <i class="material-icons">share</i>
            </button>
          </div>
          <div id="subscription-info" [class.expanded]="isSubscriptionExpanded">
            @if (subscription) {
              <span>Subscribed {{ subscription.subscribedAt | formatDate }}</span>
            }
          </div>
        </div>
      </div>
      <div id="description-container">
        <div class="divider"></div>
        <span>Description</span>
        <div id="channel-description">
          @if (channel) {
            <p class="description-text">{{ channel.description }}</p>
          }
        </div>
        <div class="divider"></div>
      </div>
      <div id="links-container">
        <span>Links</span>
        <div id="channel-links">
          @for (link of links; track link.id) {
            <div class="channel-link">
              <span>{{ link.title }}</span>
              <i class="material-icons arrow-fwd">arrow_forward</i>
              <div class="link-wrapper">
                <a [href]="link.url" target="_blank">{{ link.url }}</a>
              </div>
            </div>
          }
        </div>
      </div>
    </div>
  </div>
</main>
