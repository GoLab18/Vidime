<div class="channel-create-container">
  <div class="channel-create-card">
    <h1>Create Channel</h1>
    <p class="subtitle">Add your channel name, description, and profile picture</p>

    <form [formGroup]="channelForm" (ngSubmit)="onSubmit()" class="channel-form">
      @if (error) {
        <app-hint-bubble [hint]="error" [isError]="true"></app-hint-bubble>
      }

      @if (isSuccess) {
        <app-hint-bubble [hint]="successMessage" [isError]="false"></app-hint-bubble>
      }

      <div class="form-group picture-upload">
        <div class="image-preview" [class.has-image]="previewUrl">
          @if (!previewUrl) {
            <div class="upload-placeholder">
              <i class="material-icons">add_a_photo</i>
              <span>Channel Picture</span>
            </div>
          }
          @if (previewUrl) {
            <img [src]="previewUrl" alt="Channel preview" class="preview-image">
          }
          <input
            type="file"
            id="channel-picture"
            formControlName="picture"
            accept="image/*"
            (change)="onFileSelected($event)"
            class="file-input"
          >
        </div>

        <p class="hint">Recommended size: <span class="hint-bold">800x800px</span>. Max <span class="hint-bold">{{ maxFileSize | formatFileSize }}</span>.</p>

        @if(previewUrl) {
          <div class="clear-preview-icon" (click)="onClearPreview()">
            <i class="material-icons">clear</i>
          </div>
        }
      </div>

      <app-form-group-tile
        [control]="nameControl"
        controlName="name"
        [maxLength]="maxLengthName"
        label="Channel Name"
        icon="badge"
        placeholder="Enter your channel name"
        [errors]="[
          { type: 'required', message: 'Channel name is required' },
          { type: 'minlength', message: 'Channel name must be at least 3 characters long' },
          { type: 'pattern', message: 'Only letters, numbers, spaces, hyphens, and underscores are allowed' }
        ]"
      ></app-form-group-tile>

      <app-form-group-tile
        [control]="descriptionControl"
        controlName="description"
        [maxLength]="maxLengthDescription"
        [useTextArea]="true"
        label="Channel Description"
        placeholder="Tell viewers about your channel"
        [errors]="[
          { type: 'required', message: 'Description is required' },
          { type: 'maxlength', message: 'Description cannot exceed 1000 characters' }
        ]"
      ></app-form-group-tile>

      <button 
        type="submit" 
        class="submit-button" 
        [disabled]="channelForm.invalid || isLoading"
      >
        @if (isLoading) {
          <span class="loading-spinner"></span>
        }
        {{ isLoading ? 'Creating...' : 'Create Channel' }}
      </button>
    </form>
  </div>
</div>