<main id="main-content">
  <app-video-player [videoId]="videoId"></app-video-player>
  
  <div id="info-panel" [class.collapsed]="commentSectionCollapsed">
    <div class="collapse-btn-wrapper">
      <button id="collapse-btn" (click)="toggleCommentSectionPanel()">
        <span *ngIf="commentSectionCollapsed">Show Comments</span>
        <span *ngIf="!commentSectionCollapsed" class="hide-comments">Hide Comments</span>
      </button>
    </div>
    <div *ngIf="!commentSectionCollapsed" class="comments-section">
      <div class="comments-header">
        <h3>{{ comments.length }} Comments</h3>
        <div class="sort-options">
          <button class="sort-button active">Newest</button>
          <button class="sort-button">Top</button>
        </div>
      </div>
      
      <div class="comment-form">
        <div class="form-group">
          <input type="text" [(ngModel)]="newComment.author" placeholder="Your name" class="author-input">
        </div>
        <div class="form-group">
          <textarea [(ngModel)]="newComment.content" placeholder="Write a comment..." class="comment-input"></textarea>
        </div>
        <button (click)="addComment()" class="submit-button" [disabled]="!newComment.content.trim()">Post Comment</button>
      </div>

      <div class="comments-list">
        @for (comment of comments; track comment.id) {
          <div class="comment-item">
            <div class="comment-header">
              <div class="comment-author">
                <span class="author-name">{{comment.author}}</span>
                <span class="comment-timestamp">• {{comment.timestamp}}</span>
              </div>
              <div class="comment-actions">
                <button class="action-button">
                  <i class="material-icons">thumb_up</i>
                  <span>{{comment.likes}}</span>
                </button>
                <button class="action-button">
                  <i class="material-icons">reply</i>
                </button>
              </div>
            </div>
            <div class="comment-content">
              {{comment.content}}
            </div>
            <div class="replies" *ngIf="comment.replies.length > 0">
              @for (reply of comment.replies; track reply.id) {
                <div class="reply-item">
                  <div class="reply-header">
                    <span class="author-name">{{reply.author}}</span>
                    <span class="comment-timestamp">• {{reply.timestamp}}</span>
                  </div>
                  <div class="reply-content">
                    {{reply.content}}
                  </div>
                </div>
              }
            </div>
          </div>
        }
      </div>
    </div>
  </div>

  <div class="side-section-overlay">
    <div #sideSection id="side-section">
      <div class="carousel-overlay"></div>
      <div class="related-carousel">
        <div class="carousel-title">Related Videos</div>
        <div class="carousel-list">
          @for (related of relatedVideos; track related.id) {
            <app-related-video [video]="related"></app-related-video>
          }
        </div>
      </div>
    </div>
  </div>
</main>
